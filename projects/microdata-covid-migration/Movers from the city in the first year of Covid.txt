clear
require no.ssb.fdb:9 as ds

// Finner utflytterne fra Oslo 2016
create-dataset ut2016
import ds/BEFOLKNING_KJOENN as kjonn

// finner de som har bodd i Oslo. Hiver ut de andre for å begrense utvalget.  
import ds/BEFOLKNING_KOMMNR_FORMELL 2016-01-01 as boddeioslo
keep if (boddeioslo == '0301')

// identifiserer utvandrerne
import ds/BEFOLKNING_STATUSKODE 2017-01-01 as statusdes
import ds/BEFOLKNING_STATUSKODE 2016-01-01 as statusjan
keep if (statusjan == '1' & statusdes != '5')
generate utv = 0
replace utv = 1 if statusjan == '1' & statusdes == '3'
// Her får vi altså ikke flergangsmigrantene.

// identifiserer utflytterne
import ds/BEFOLKNING_KOMMNR_FORMELL 2017-01-01 as komdes
generate utfl = 0
replace utfl = 1 if (komdes != '0301' & statusdes == '1')

generate staygo = 0
replace staygo = 1 if utfl == 1
replace staygo = 2 if utv == 1

import ds/BEFOLKNING_FOEDSELS_AAR_MND as fodt
generate alder = 2015 - int(fodt / 100)
//tabulate alder staygo

generate yrkesalder = 0
replace yrkesalder = 1 if (alder >= 15 & alder <= 74)

import ds/REGSYS_ARB_YRKE_STYRK08 2015-11-16 as styrk08
generate styrk = substr(styrk08,1,1)
generate hartall = 0
replace hartall = 1 if styrk >= '0'
generate yrke = 0
replace yrke = 1 if styrk == '1'
replace yrke = 2 if styrk == '2'
replace yrke = 3 if styrk == '3'
replace yrke = 4 if styrk == '4'
replace yrke = 5 if styrk == '5'
replace yrke = 6 if styrk == '7'
replace yrke = 7 if styrk == '9'
replace yrke = 8 if (styrk == '0' | styrk == '6' | styrk == '8')
replace yrke = 9 if hartall == 0
//tabulate yrke staygo if yrkesalder == 1

import ds/BEFOLKNING_FOEDEKOMMNR as fodtkom
generate fodtoslo = 0
replace fodtoslo = 1 if fodtkom == '0301'
//tabulate fodtoslo staygo

import ds/BEFOLKNING_ANTPERS_I_REGSTAT_FAMNR 2016-01-01 as famstr
generate fam = 0
replace fam = 1 if famstr == 1
replace fam = 2 if famstr == 2
replace fam = 3 if famstr == 3
replace fam = 4 if famstr == 4
replace fam = 5 if famstr >= 5
//tabulate fam staygo

import ds/BOFORHOLD_EIE_LEIE 2016-01-01 as eieleie
//tabulate eieleie staygo

import ds/BEFOLKNING_INVKAT as invkat
generate innv = 0
replace innv = 1 if invkat == 'B'
replace innv = 2 if invkat == 'C'
//tabulate innv staygo

import ds/BEFOLKNING_REGSTAT_FAMTYP 2016-01-01 as familietype
generate famtyp = substr(familietype,1,3)
//tabulate famtyp staygo

import ds/BEFOLKNING_FODELAND as fland
generate fodeland = 0
replace fodeland = 1 if fland == '000'
replace fodeland = 2 if (fland >= '101' & fland <= '106')
replace fodeland = 3 if (fland >= '110' & fland <= '199')
replace fodeland = 4 if (fland >= '200' & fland <= '840')
//tabulate fodeland staygo

import ds/BEFOLKNING_BARN_I_REGSTAT_FAMNR 2016-01-01 as brn
generate barn = brn
replace barn = 4 if brn >= 4
//tabulate barn staygo

// Hvor flyttet de?
generate fylke = substr(komdes,1,2)
//tabulate fylke staygo

// flere kjennetegn:
generate mann = 0
replace mann = 1 if kjonn == '1'

generate aldgrp = 0
replace aldgrp = 1 if (alder >= 0 & alder <= 5)
replace aldgrp = 2 if (alder >= 6 & alder <= 17)
replace aldgrp = 3 if (alder >= 18 & alder <= 24)
replace aldgrp = 4 if (alder >= 25 & alder <= 34)
replace aldgrp = 5 if (alder >= 35 & alder <= 44)
replace aldgrp = 6 if alder >= 45

import ds/BEFOLKNING_INNGRUNN1 as inngrunn
generate inngr = 0
replace inngr = 1 if inngrunn == 'ARB'
replace inngr = 2 if inngrunn == 'FAM'
replace inngr = 3 if inngrunn == 'FLU'

import ds/BEFOLKNING_FORSTDATO as forstdato
generate forstaar = int (forstdato/10000)
generate botid = int (2016-forstaar) 

generate botidgrp = 0
replace botidgrp = 1 if (botid == 1 & invkat =='B')
replace botidgrp = 2 if (botid >=2 & botid <=4 & invkat =='B')
replace botidgrp = 3 if (botid >=5 & botid <=10 & invkat =='B')
replace botidgrp = 4 if (botid >= 11 & invkat =='B')

import ds/INNTEKT_WSAMINNT 2015-12-31 as inntekt
generate inntgrp = 0
replace inntgrp = 1 if (inntekt >= 200000 & inntekt <=499999)
replace inntgrp = 2 if (inntekt >= 500000 & inntekt <=9999999)
replace inntgrp = 3 if (inntekt >= 1000000)

mlogit staygo mann i.aldgrp i.yrke i.famtyp i.inntgrp i.eieleie fodtoslo i.innv

keep if invkat == 'B'
mlogit staygo mann i.aldgrp i.yrke i.famtyp i.inntgrp i.eieleie i.fodeland i.inngr i.botidgrp

//////////////////////////////////////////////////////////////////////////

// Finner utflytterne fra Oslo 2017
create-dataset ut2017
import ds/BEFOLKNING_KJOENN as kjonn
import ds/BEFOLKNING_KOMMNR_FORMELL 2017-01-01 as boddeioslo
keep if (boddeioslo == '0301')

// identifiserer utvandrerne
import ds/BEFOLKNING_STATUSKODE 2018-01-01 as statusdes
import ds/BEFOLKNING_STATUSKODE 2017-01-01 as statusjan
keep if (statusjan == '1' & statusdes != '5')
generate utv = 0
replace utv = 1 if statusjan == '1' & statusdes == '3'
// Her får vi altså ikke flergangsmigrantene.

// identifiserer utflytterne
import ds/BEFOLKNING_KOMMNR_FORMELL 2018-01-01 as komdes
generate utfl = 0
replace utfl = 1 if (komdes != '0301' & statusdes == '1')

generate staygo = 0
replace staygo = 1 if utfl == 1
replace staygo = 2 if utv == 1

import ds/BEFOLKNING_FOEDSELS_AAR_MND as fodt
generate alder = 2016 - int(fodt / 100)
//tabulate alder staygo
generate yrkesalder = 0
replace yrkesalder = 1 if (alder >= 15 & alder <= 74)

import ds/REGSYS_ARB_YRKE_STYRK08 2016-11-16 as styrk08
generate styrk = substr(styrk08,1,1)
generate hartall = 0
replace hartall = 1 if styrk >= '0'
generate yrke = 0
replace yrke = 1 if styrk == '1'
replace yrke = 2 if styrk == '2'
replace yrke = 3 if styrk == '3'
replace yrke = 4 if styrk == '4'
replace yrke = 5 if styrk == '5'
replace yrke = 6 if styrk == '7'
replace yrke = 7 if styrk == '9'
replace yrke = 8 if (styrk == '0' | styrk == '6' | styrk == '8')
replace yrke = 9 if hartall == 0
//tabulate yrke staygo if yrkesalder == 1

import ds/BEFOLKNING_FOEDEKOMMNR as fodtkom
generate fodtoslo = 0
replace fodtoslo = 1 if fodtkom == '0301'
//tabulate fodtoslo staygo

import ds/BEFOLKNING_ANTPERS_I_REGSTAT_FAMNR 2017-01-01 as famstr
generate fam = 0
replace fam = 1 if famstr == 1
replace fam = 2 if famstr == 2
replace fam = 3 if famstr == 3
replace fam = 4 if famstr == 4
replace fam = 5 if famstr >= 5
//tabulate fam staygo

import ds/BOFORHOLD_EIE_LEIE 2017-01-01 as eieleie
//tabulate eieleie staygo

import ds/BEFOLKNING_INVKAT as invkat
generate innv = 0
replace innv = 1 if invkat == 'B'
replace innv = 2 if invkat == 'C'
//tabulate innv staygo 

import ds/BEFOLKNING_REGSTAT_FAMTYP 2017-01-01 as familietype
generate famtyp = substr(familietype,1,3)
//tabulate famtyp staygo

import ds/BEFOLKNING_FODELAND as fland
generate fodeland = 0
replace fodeland = 1 if fland == '000'
replace fodeland = 2 if (fland >= '101' & fland <= '106')
replace fodeland = 3 if (fland >= '110' & fland <= '199')
replace fodeland = 4 if (fland >= '200' & fland <= '840')
//tabulate fodeland staygo

import ds/BEFOLKNING_BARN_I_REGSTAT_FAMNR 2017-01-01 as brn
generate barn = brn
replace barn = 4 if brn >= 4
//tabulate barn staygo

// Hvor flyttet de?
generate fylke = substr(komdes,1,2)
//tabulate fylke staygo

// flere kjennetegn:
generate mann = 0
replace mann = 1 if kjonn == '1'

generate aldgrp = 0
replace aldgrp = 1 if (alder >= 0 & alder <= 5)
replace aldgrp = 2 if (alder >= 6 & alder <= 17)
replace aldgrp = 3 if (alder >= 18 & alder <= 24)
replace aldgrp = 4 if (alder >= 25 & alder <= 34)
replace aldgrp = 5 if (alder >= 35 & alder <= 44)
replace aldgrp = 6 if alder >= 45

import ds/BEFOLKNING_INNGRUNN1 as inngrunn
generate inngr = 0
replace inngr = 1 if inngrunn == 'ARB'
replace inngr = 2 if inngrunn == 'FAM'
replace inngr = 3 if inngrunn == 'FLU'

import ds/BEFOLKNING_FORSTDATO as forstdato
generate forstaar = int (forstdato/10000)
generate botid = int (2017-forstaar) 

generate botidgrp = 0
replace botidgrp = 1 if (botid == 1 & invkat =='B')
replace botidgrp = 2 if (botid >=2 & botid <=4 & invkat =='B')
replace botidgrp = 3 if (botid >=5 & botid <=10 & invkat =='B')
replace botidgrp = 4 if (botid >= 11 & invkat =='B')

import ds/INNTEKT_WSAMINNT 2016-12-31 as inntekt
generate inntgrp = 0
replace inntgrp = 1 if (inntekt >= 200000 & inntekt <=499999)
replace inntgrp = 2 if (inntekt >= 500000 & inntekt <=9999999)
replace inntgrp = 3 if (inntekt >= 1000000)


mlogit staygo mann i.aldgrp i.yrke i.famtyp i.inntgrp i.eieleie fodtoslo i.innv

keep if invkat == 'B'
mlogit staygo mann i.aldgrp i.yrke i.famtyp i.inntgrp i.eieleie i.fodeland i.inngr i.botidgrp



/////////////////////////////////////////////////////////////////////

// Finner utflytterne fra Oslo 2018
create-dataset ut2018
import ds/BEFOLKNING_KJOENN as kjonn
import ds/BEFOLKNING_KOMMNR_FORMELL 2018-01-01 as boddeioslo
keep if (boddeioslo == '0301')

// identifiserer utvandrerne
import ds/BEFOLKNING_STATUSKODE 2019-01-01 as statusdes
import ds/BEFOLKNING_STATUSKODE 2018-01-01 as statusjan
keep if (statusjan == '1' & statusdes != '5')
generate utv = 0
replace utv = 1 if statusjan == '1' & statusdes == '3'
// Her får vi altså ikke flergangsmigrantene.

// identifiserer utflytterne
import ds/BEFOLKNING_KOMMNR_FORMELL 2019-01-01 as komdes
generate utfl = 0
replace utfl = 1 if (komdes != '0301' & statusjan == '1')

generate staygo = 0
replace staygo = 1 if utfl == 1
replace staygo = 2 if utv == 1

import ds/BEFOLKNING_FOEDSELS_AAR_MND as fodt
generate alder = 2017 - int(fodt / 100)
//tabulate alder staygo
generate yrkesalder = 0
replace yrkesalder = 1 if (alder >= 15 & alder <= 74)

import ds/REGSYS_ARB_YRKE_STYRK08 2017-11-16 as styrk08
generate styrk = substr(styrk08,1,1)
generate hartall = 0
replace hartall = 1 if styrk >= '0'
generate yrke = 0
replace yrke = 1 if styrk == '1'
replace yrke = 2 if styrk == '2'
replace yrke = 3 if styrk == '3'
replace yrke = 4 if styrk == '4'
replace yrke = 5 if styrk == '5'
replace yrke = 6 if styrk == '7'
replace yrke = 7 if styrk == '9'
replace yrke = 8 if (styrk == '0' | styrk == '6' | styrk == '8')
replace yrke = 9 if hartall == 0
//tabulate yrke staygo if yrkesalder == 1

import ds/BEFOLKNING_FOEDEKOMMNR as fodtkom
generate fodtoslo = 0
replace fodtoslo = 1 if fodtkom == '0301'
//tabulate fodtoslo staygo

import ds/BEFOLKNING_ANTPERS_I_REGSTAT_FAMNR 2018-01-01 as famstr
generate fam = 0
replace fam = 1 if famstr == 1
replace fam = 2 if famstr == 2
replace fam = 3 if famstr == 3
replace fam = 4 if famstr == 4
replace fam = 5 if famstr >= 5
//tabulate fam staygo

import ds/BOFORHOLD_EIE_LEIE 2018-01-01 as eieleie
//tabulate eieleie staygo

import ds/BEFOLKNING_INVKAT as invkat
generate innv = 0
replace innv = 1 if invkat == 'B'
replace innv = 2 if invkat == 'C'
//tabulate innv staygo

import ds/BEFOLKNING_REGSTAT_FAMTYP 2018-01-01 as familietype
generate famtyp = substr(familietype,1,3)
//tabulate famtyp staygo

import ds/BEFOLKNING_FODELAND as fland
generate fodeland = 0
replace fodeland = 1 if fland == '000'
replace fodeland = 2 if (fland >= '101' & fland <= '106')
replace fodeland = 3 if (fland >= '110' & fland <= '199')
replace fodeland = 4 if (fland >= '200' & fland <= '840')
//tabulate fodeland staygo

import ds/BEFOLKNING_BARN_I_REGSTAT_FAMNR 2018-01-01 as brn
generate barn = brn
replace barn = 4 if brn >= 4
//tabulate barn staygo

// Hvor flyttet de?
generate fylke = substr(komdes,1,2)
//tabulate fylke staygo

// flere kjennetegn:
generate mann = 0
replace mann = 1 if kjonn == '1'

generate aldgrp = 0
replace aldgrp = 1 if (alder >= 0 & alder <= 5)
replace aldgrp = 2 if (alder >= 6 & alder <= 17)
replace aldgrp = 3 if (alder >= 18 & alder <= 24)
replace aldgrp = 4 if (alder >= 25 & alder <= 34)
replace aldgrp = 5 if (alder >= 35 & alder <= 44)
replace aldgrp = 6 if alder >= 45

import ds/BEFOLKNING_INNGRUNN1 as inngrunn
generate inngr = 0
replace inngr = 1 if inngrunn == 'ARB'
replace inngr = 2 if inngrunn == 'FAM'
replace inngr = 3 if inngrunn == 'FLU'

import ds/BEFOLKNING_FORSTDATO as forstdato
generate forstaar = int (forstdato/10000)
generate botid = int (2018-forstaar) 

generate botidgrp = 0
replace botidgrp = 1 if (botid == 1 & invkat =='B')
replace botidgrp = 2 if (botid >=2 & botid <=4 & invkat =='B')
replace botidgrp = 3 if (botid >=5 & botid <=10 & invkat =='B')
replace botidgrp = 4 if (botid >= 11 & invkat =='B')

import ds/INNTEKT_WSAMINNT 2017-12-31 as inntekt
generate inntgrp = 0
replace inntgrp = 1 if (inntekt >= 200000 & inntekt <=499999)
replace inntgrp = 2 if (inntekt >= 500000 & inntekt <=9999999)
replace inntgrp = 3 if (inntekt >= 1000000)


mlogit staygo mann i.aldgrp i.yrke i.famtyp i.inntgrp i.eieleie fodtoslo i.innv

keep if invkat == 'B'
mlogit staygo mann i.aldgrp i.yrke i.famtyp i.inntgrp i.eieleie i.fodeland i.inngr i.botidgrp



/////////////////////////////////////////////////////////////////////



// Finner utflytterne fra Oslo 2019
create-dataset ut2019
import ds/BEFOLKNING_KJOENN as kjonn
// dette er variabelen som microdata.no anbefaler å begynne med. Flere kjennetegn kommer lenger ned.

// finner de som har bodd i Oslo. Hiver ut de andre for å begrense utvalget.  
import ds/BEFOLKNING_KOMMNR_FORMELL 2019-01-01 as boddeioslo
keep if (boddeioslo == '0301')

// identifiserer utvandrerne
import ds/BEFOLKNING_STATUSKODE 2020-01-01 as statusdes
import ds/BEFOLKNING_STATUSKODE 2019-01-01 as statusjan
keep if (statusjan == '1' & statusdes != '5')
generate utv = 0
replace utv = 1 if statusjan == '1' & statusdes == '3'
// Her får vi altså ikke flergangsmigrantene.

// identifiserer utflytterne
import ds/BEFOLKNING_KOMMNR_FORMELL 2020-01-01 as komdes
generate utfl = 0
replace utfl = 1 if (komdes != '0301' & statusjan == '1')

generate staygo = 0
replace staygo = 1 if utfl == 1
replace staygo = 2 if utv == 1

import ds/BEFOLKNING_FOEDSELS_AAR_MND as fodt
generate alder = 2018 - int(fodt / 100)
//tabulate alder staygo
generate yrkesalder = 0
replace yrkesalder = 1 if (alder >= 15 & alder <= 74)

import ds/REGSYS_ARB_YRKE_STYRK08 2018-11-16 as styrk08
generate styrk = substr(styrk08,1,1)
generate hartall = 0
replace hartall = 1 if styrk >= '0'
generate yrke = 0
replace yrke = 1 if styrk == '1'
replace yrke = 2 if styrk == '2'
replace yrke = 3 if styrk == '3'
replace yrke = 4 if styrk == '4'
replace yrke = 5 if styrk == '5'
replace yrke = 6 if styrk == '7'
replace yrke = 7 if styrk == '9'
replace yrke = 8 if (styrk == '0' | styrk == '6' | styrk == '8')
replace yrke = 9 if hartall == 0
//tabulate yrke staygo if yrkesalder == 1

import ds/BEFOLKNING_FOEDEKOMMNR as fodtkom
generate fodtoslo = 0
replace fodtoslo = 1 if fodtkom == '0301'
//tabulate fodtoslo staygo

import ds/BEFOLKNING_ANTPERS_I_REGSTAT_FAMNR 2019-01-01 as famstr
generate fam = 0
replace fam = 1 if famstr == 1
replace fam = 2 if famstr == 2
replace fam = 3 if famstr == 3
replace fam = 4 if famstr == 4
replace fam = 5 if famstr >= 5
//tabulate fam staygo

import ds/BOFORHOLD_EIE_LEIE 2019-01-01 as eieleie
//tabulate eieleie staygo

import ds/BEFOLKNING_INVKAT as invkat
generate innv = 0
replace innv = 1 if invkat == 'B'
replace innv = 2 if invkat == 'C'
//tabulate innv staygo

import ds/BEFOLKNING_REGSTAT_FAMTYP 2019-01-01 as familietype
generate famtyp = substr(familietype,1,3)
//tabulate famtyp staygo

import ds/BEFOLKNING_FODELAND as fland
generate fodeland = 0
replace fodeland = 1 if fland == '000'
replace fodeland = 2 if (fland >= '101' & fland <= '106')
replace fodeland = 3 if (fland >= '110' & fland <= '199')
replace fodeland = 4 if (fland >= '200' & fland <= '840')
//tabulate fodeland staygo

import ds/BEFOLKNING_BARN_I_REGSTAT_FAMNR 2019-01-01 as brn
generate barn = brn
replace barn = 4 if brn >= 4
//tabulate barn staygo

// Hvor flyttet de?
// hermer fra microdata-manualen
generate fylke = substr(komdes,1,2)
define-labels fylkerstring '03' 'Oslo' '11' 'Rogaland' '15' 'Møre og Romsdal' '18' 'Nordland' '30' 'Viken' '34' 'Innlandet' '38' 'Vestfold og Telemark' '42' 'Agder' '46' 'Vestland' '50' 'Trøndelag' '54' 'Troms og Finnmark' '99' 'Uoppgitt'
assign-labels fylke fylkerstring
//tabulate fylke staygo

// flere kjennetegn:
generate mann = 0
replace mann = 1 if kjonn == '1'

generate aldgrp = 0
replace aldgrp = 1 if (alder >= 0 & alder <= 5)
replace aldgrp = 2 if (alder >= 6 & alder <= 17)
replace aldgrp = 3 if (alder >= 18 & alder <= 24)
replace aldgrp = 4 if (alder >= 25 & alder <= 34)
replace aldgrp = 5 if (alder >= 35 & alder <= 44)
replace aldgrp = 6 if alder >= 45

import ds/BEFOLKNING_INNGRUNN1 as inngrunn
generate inngr = 0
replace inngr = 1 if inngrunn == 'ARB'
replace inngr = 2 if inngrunn == 'FAM'
replace inngr = 3 if inngrunn == 'FLU'

import ds/BEFOLKNING_FORSTDATO as forstdato
generate forstaar = int (forstdato/10000)
generate botid = int (2019-forstaar) 

generate botidgrp = 0
replace botidgrp = 1 if (botid == 1 & invkat =='B')
replace botidgrp = 2 if (botid >=2 & botid <=4 & invkat =='B')
replace botidgrp = 3 if (botid >=5 & botid <=10 & invkat =='B')
replace botidgrp = 4 if (botid >= 11 & invkat =='B')

import ds/INNTEKT_WSAMINNT 2018-12-31 as inntekt
generate inntgrp = 0
replace inntgrp = 1 if (inntekt >= 200000 & inntekt <=499999)
replace inntgrp = 2 if (inntekt >= 500000 & inntekt <=9999999)
replace inntgrp = 3 if (inntekt >= 1000000)

mlogit staygo mann i.aldgrp i.yrke i.famtyp i.inntgrp i.eieleie fodtoslo i.innv

keep if invkat == 'B'
mlogit staygo mann i.aldgrp i.yrke i.famtyp i.inntgrp i.eieleie i.fodeland i.inngr i.botidgrp



/////////////////////////////////////////////////////////////////////


// Finner utflytterne fra Oslo 2020
create-dataset ut2020
import ds/BEFOLKNING_KJOENN as kjonn

import ds/BEFOLKNING_KOMMNR_FORMELL 2020-01-01 as boddeioslo
keep if (boddeioslo == '0301')

// identifiserer utvandrerne
import ds/BEFOLKNING_STATUSKODE 2021-01-01 as statusdes
import ds/BEFOLKNING_STATUSKODE 2020-01-01 as statusjan
keep if (statusjan == '1' & statusdes != '5')
generate utv = 0
replace utv = 1 if statusjan == '1' & statusdes == '3'
// Her får vi altså ikke flergangsmigrantene.

// identifiserer utflytterne
import ds/BEFOLKNING_KOMMNR_FORMELL 2021-01-01 as komdes
generate utfl = 0
replace utfl = 1 if (komdes != '0301' & statusjan == '1')

generate staygo = 0
replace staygo = 1 if utfl == 1
replace staygo = 2 if utv == 1

import ds/BEFOLKNING_FOEDSELS_AAR_MND as fodt
generate alder = 2019 - int(fodt / 100)
// tabulate alder staygo
generate yrkesalder = 0
replace yrkesalder = 1 if (alder >= 15 & alder <= 74)

import ds/REGSYS_ARB_YRKE_STYRK08 2019-11-16 as styrk08
generate styrk = substr(styrk08,1,1)
generate hartall = 0
replace hartall = 1 if styrk >= '0'
generate yrke = 0
replace yrke = 1 if styrk == '1'
replace yrke = 2 if styrk == '2'
replace yrke = 3 if styrk == '3'
replace yrke = 4 if styrk == '4'
replace yrke = 5 if styrk == '5'
replace yrke = 6 if styrk == '7'
replace yrke = 7 if styrk == '9'
replace yrke = 8 if (styrk == '0' | styrk == '6' | styrk == '8')
replace yrke = 9 if hartall == 0
//tabulate yrke staygo if yrkesalder == 1

import ds/BEFOLKNING_FOEDEKOMMNR as fodtkom
generate fodtoslo = 0
replace fodtoslo = 1 if fodtkom == '0301'
//tabulate fodtoslo staygo

import ds/BEFOLKNING_ANTPERS_I_REGSTAT_FAMNR 2020-01-01 as famstr
generate fam = 0
replace fam = 1 if famstr == 1
replace fam = 2 if famstr == 2
replace fam = 3 if famstr == 3
replace fam = 4 if famstr == 4
replace fam = 5 if famstr >= 5
//tabulate fam staygo

import ds/BOFORHOLD_EIE_LEIE 2020-01-01 as eieleie
//tabulate eieleie staygo

import ds/BEFOLKNING_INVKAT as invkat
generate innv = 0
replace innv = 1 if invkat == 'B'
replace innv = 2 if invkat == 'C'
//tabulate innv staygo

import ds/BEFOLKNING_REGSTAT_FAMTYP 2020-01-01 as familietype
generate famtyp = substr(familietype,1,3)
//tabulate famtyp staygo

import ds/BEFOLKNING_FODELAND as fland
generate fodeland = 0
replace fodeland = 1 if fland == '000' 
replace fodeland = 2 if (fland >= '101' & fland <= '106')
replace fodeland = 3 if (fland >= '110' & fland <= '199')
replace fodeland = 4 if (fland >= '200' & fland <= '840')
//tabulate fodeland staygo

import ds/BEFOLKNING_BARN_I_REGSTAT_FAMNR 2020-01-01 as brn
generate barn = brn
replace barn = 4 if brn >= 4
//tabulate barn staygo

// Hvor flyttet de?
generate fylke = substr(komdes,1,2)
//tabulate fylke staygo

// flere kjennetegn:
generate mann = 0
replace mann = 1 if kjonn == '1'

generate aldgrp = 0
replace aldgrp = 1 if (alder >= 0 & alder <= 5)
replace aldgrp = 2 if (alder >= 6 & alder <= 17)
replace aldgrp = 3 if (alder >= 18 & alder <= 24)
replace aldgrp = 4 if (alder >= 25 & alder <= 34)
replace aldgrp = 5 if (alder >= 35 & alder <= 44)
replace aldgrp = 6 if alder >= 45

import ds/BEFOLKNING_INNGRUNN1 as inngrunn
generate inngr = 0
replace inngr = 1 if inngrunn == 'ARB'
replace inngr = 2 if inngrunn == 'FAM'
replace inngr = 3 if inngrunn == 'FLU'

import ds/BEFOLKNING_FORSTDATO as forstdato
generate forstaar = int (forstdato/10000)
generate botid = int (2020-forstaar) 

generate botidgrp = 0
replace botidgrp = 1 if (botid == 1 & invkat =='B')
replace botidgrp = 2 if (botid >=2 & botid <=4 & invkat =='B')
replace botidgrp = 3 if (botid >=5 & botid <=10 & invkat =='B')
replace botidgrp = 4 if (botid >= 11 & invkat =='B')

import ds/INNTEKT_WSAMINNT 2019-12-31 as inntekt
generate inntgrp = 0
replace inntgrp = 1 if (inntekt >= 200000 & inntekt <=499999)
replace inntgrp = 2 if (inntekt >= 500000 & inntekt <=9999999)
replace inntgrp = 3 if (inntekt >= 1000000)

mlogit staygo mann i.aldgrp i.yrke i.famtyp i.inntgrp i.eieleie fodtoslo i.innv

keep if invkat == 'B'
mlogit staygo mann i.aldgrp i.yrke i.famtyp i.inntgrp i.eieleie i.fodeland i.inngr i.botidgrp

